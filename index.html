<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bipolar Chat - Dual Mode</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <style>
        * { box-sizing: border-box; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Courier New', monospace; overflow: hidden; transition: 0.5s; }

        /* TELA DE LOGIN */
        #login-screen {
            position: fixed; inset: 0; background: #000; z-index: 1000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .login-box { border: 2px solid #ff0055; padding: 30px; border-radius: 20px; text-align: center; background: #0a0a0a; box-shadow: 0 0 20px #ff0055; }

        /* INTERFACE PRINCIPAL */
        #main-app { display: none; height: 100vh; flex-direction: column; align-items: center; justify-content: center; position: relative; }

        /* LAYOUT CANAL 1 (FOFO) */
        .canal1-mode { background: #fff1f5; color: #ff0055; }
        .canal1-mode .chat-box { border: 4px solid #ff0055; background: rgba(255, 255, 255, 0.9); box-shadow: 0 0 20px #ffb6c1; }

        /* LAYOUT CANAL 2 (TERROR) */
        .canal2-mode { background: #050000; color: #ff0000; }
        .canal2-mode .chat-box { border: 4px solid #330000; background: rgba(10, 0, 0, 0.9); box-shadow: 0 0 30px #ff0000; }

        /* ELEMENTOS DO CHAT */
        .chat-box { width: 400px; height: 500px; border-radius: 20px; display: flex; flex-direction: column; z-index: 10; overflow: hidden; }
        #messages { flex: 1; overflow-y: auto; padding: 15px; font-weight: bold; }
        .input-area { display: flex; padding: 10px; background: rgba(0,0,0,0.1); }
        input { flex: 1; padding: 10px; border-radius: 5px; border: 1px solid #ccc; outline: none; }
        
        /* BOTÃ•ES DE TROCA */
        .nav-channels { position: absolute; top: 20px; display: flex; gap: 10px; z-index: 20; }
        .btn-ch { padding: 10px 20px; cursor: pointer; font-weight: bold; border-radius: 30px; border: 2px solid; }

        /* PONTUAÃ‡ÃƒO */
        .score-box { position: absolute; top: 20px; right: 20px; font-size: 24px; font-weight: bold; z-index: 20; text-shadow: 2px 2px #000; }

        /* EMOJIS FLUTUANTES */
        .floating {
            position: absolute; cursor: pointer; font-size: 40px; user-select: none;
            z-index: 1; transition: 0.2s;
        }
    </style>
</head>
<body class="canal1-mode">

    <div id="login-screen">
        <div class="login-box">
            <h1 style="color:#ff0055">BIPOLAR ACCESS</h1>
            <input type="text" id="user" placeholder="UsuÃ¡rio"><br><br>
            <input type="password" id="pass" placeholder="Senha (6 dÃ­gitos)"><br><br>
            <button onclick="logar()" style="background:#ff0055; color:white; border:none; padding:10px 20px; cursor:pointer; width:100%">ENTRAR</button>
        </div>
    </div>

    <div id="main-app">
        <div class="score-box">PONTOS: <span id="pontos">0</span></div>

        <div class="nav-channels">
            <button class="btn-ch" onclick="mudarCanal('canal1')" style="background:#ffb6c1; color:#ff0055;">MODO FOFO ðŸ’–</button>
            <button class="btn-ch" onclick="mudarCanal('canal2')" style="background:#330000; color:#ff0000;">MODO TERROR ðŸ’€</button>
        </div>

        <div class="chat-box">
            <div style="padding: 10px; text-align: center; font-weight: bold; border-bottom: 1px solid #eee;" id="chat-header">CANAL 1 - AMOR</div>
            <div id="messages"></div>
            <div class="input-area">
                <input type="text" id="msg" placeholder="Diga algo...">
                <button onclick="enviar()" style="margin-left:5px; cursor:pointer">ENVIAR</button>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD7GIQgMVr0lf4BOyQkXBh_Qhk-GK6wMK4",
            authDomain: "chat2000-5815b.firebaseapp.com",
            databaseURL: "https://chat2000-5815b-default-rtdb.firebaseio.com",
            projectId: "chat2000-5815b",
            storageBucket: "chat2000-5815b.firebasestorage.app",
            messagingSenderId: "88820669466",
            appId: "1:88820669466:web:df968acfebc5bd31ec85a3"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        let canalAtual = 'canal1';
        let pontos = 0;

        // LOGIN
        function logar() {
            const u = document.getElementById('user').value;
            const p = document.getElementById('pass').value;
            if(!u || p.length < 6) return alert("Preencha corretamente!");
            const email = u.trim().toLowerCase() + "@bipolar.com";
            auth.signInWithEmailAndPassword(email, p).catch(() => auth.createUserWithEmailAndPassword(email, p));
        }

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-app').style.display = 'flex';
                mudarCanal('canal1');
                startParticles();
            }
        });

        // TROCA DE CANAL (AQUI A MÃGICA ACONTECE)
        function mudarCanal(ch) {
            canalAtual = ch;
            const body = document.body;
            const header = document.getElementById('chat-header');
            
            if(ch === 'canal1') {
                body.className = 'canal1-mode';
                header.innerText = "CANAL 1 - AMOR ðŸ’–";
            } else {
                body.className = 'canal2-mode';
                header.innerText = "CANAL 2 - TERROR ðŸ’€";
            }

            // Carrega mensagens especÃ­ficas deste canal
            document.getElementById('messages').innerHTML = "";
            db.ref("chat_" + ch).off();
            db.ref("chat_" + ch).limitToLast(20).on("child_added", snap => {
                const d = snap.val();
                const mDiv = document.getElementById('messages');
                mDiv.innerHTML += `<div><b style="color:#ff0055">${d.user}:</b> ${d.text}</div>`;
                mDiv.scrollTop = mDiv.scrollHeight;
            });
        }

        function enviar() {
            const t = document.getElementById('msg').value;
            if(t.trim()) {
                db.ref("chat_" + canalAtual).push({
                    user: auth.currentUser.email.split('@')[0],
                    text: t
                });
                document.getElementById('msg').value = "";
            }
        }

        // ENTER PARA ENVIAR
        document.addEventListener('keypress', e => {
            if(e.key === 'Enter') {
                if(document.getElementById('main-app').style.display === 'flex') enviar();
                else logar();
            }
        });

        // EFEITOS FLUTUANTES E PONTUAÃ‡ÃƒO
        function startParticles() {
            setInterval(() => {
                const emoji = canalAtual === 'canal1' ? 'ðŸ’–' : 'ðŸ’€';
                const p = document.createElement('div');
                p.className = 'floating';
                p.innerHTML = emoji;
                p.style.left = Math.random() * 90 + 'vw';
                p.style.top = '110vh';
                
                p.onclick = () => {
                    pontos += 10;
                    document.getElementById('pontos').innerText = pontos;
                    p.style.transform = 'scale(4)';
                    p.style.opacity = '0';
                    setTimeout(() => p.remove(), 200);
                };

                document.body.appendChild(p);

                let pos = 110;
                let move = setInterval(() => {
                    pos -= 0.5;
                    p.style.top = pos + 'vh';
                    if(pos < -10) { clearInterval(move); p.remove(); }
                }, 20);
            }, 1000);
        }
    </script>
</body>
</html>
