<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dual Chat: Kawaii vs Hacker</title>
    <style>
        /* Base do Layout */
        body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; transition: 0.8s; }
        #sidebar { width: 30%; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; z-index: 2; transition: 0.5s; }
        .bg-particles { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        #toggle-btn { font-size: 80px; cursor: pointer; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); user-select: none; z-index: 3; filter: drop-shadow(0 0 10px rgba(0,0,0,0.1)); }
        #toggle-btn:hover { transform: scale(1.2); }
        
        #chat-container { width: 70%; display: flex; flex-direction: column; z-index: 2; transition: 0.5s; position: relative; }
        #header { padding: 25px; text-align: center; font-size: 28px; font-weight: bold; transition: 0.5s; letter-spacing: 1px; }
        #messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        
        .message { max-width: 75%; padding: 14px; border-radius: 20px; align-self: flex-start; transition: 0.3s; position: relative; }
        .particle { position: absolute; bottom: -50px; animation: moveUp 4s linear infinite; opacity: 0.6; font-size: 24px; }
        @keyframes moveUp { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; } }

        /* --- TEMA AMIG√ÅVEL (Kawaii Style) --- */
        .theme-amigavel { background-color: #fff5f8; color: #ff85a2; font-family: 'Comic Sans MS', 'Arial', sans-serif; }
        .theme-amigavel #sidebar { background-color: #ffeef2; border-right: 5px dotted #ffc1d1; }
        .theme-amigavel #chat-container { background: #ffffff; }
        .theme-amigavel #header { color: #ff4d7d; text-shadow: 2px 2px #ffcada; }
        .theme-amigavel .message { background: #fff0f5; color: #666; border: 2px solid #ffdae3; border-radius: 25px 25px 25px 5px; box-shadow: 3px 3px 10px rgba(255, 182, 193, 0.2); }
        .theme-amigavel .my-message { align-self: flex-end; background: #ff85a2; color: white; border-radius: 25px 25px 5px 25px; border: none; }
        .theme-amigavel #msg-input { border: 3px solid #ffc1d1; border-radius: 30px; padding: 15px; background: #fffafb; color: #ff4d7d; }
        .theme-amigavel button { background: #ff4d7d; border-radius: 50%; box-shadow: 0 4px 10px #ffcada; }

        /* --- TEMA N√ÉO AMIG√ÅVEL (Hacker Dark Neon) --- */
        .theme-nao-amigavel { background-color: #000000; color: #00ff41; font-family: 'Courier New', Courier, monospace; }
        .theme-nao-amigavel #sidebar { 
            background-color: #050505; 
            border-right: 2px solid #ff0000;
            box-shadow: 5px 0 20px rgba(255, 0, 0, 0.4); 
        }
        .theme-nao-amigavel #chat-container { background: #080808; border-left: 1px solid #ff0000; }
        .theme-nao-amigavel #header { 
            color: #ff0000; 
            text-shadow: 0 0 10px #ff0000, 0 0 20px #8b0000; 
            border-bottom: 1px solid #ff0000;
            text-transform: uppercase;
        }
        .theme-nao-amigavel .message { 
            background: #111; 
            color: #00ff41; 
            border: 1px solid #00ff41; 
            border-radius: 0px; 
            box-shadow: 0 0 5px #00ff41;
        }
        .theme-nao-amigavel .my-message { 
            align-self: flex-end; 
            background: #000; 
            color: #ff0000; 
            border: 1px solid #ff0000; 
            box-shadow: 0 0 10px #ff0000; 
        }
        .theme-nao-amigavel #msg-input { 
            background: #000; 
            border: 1px solid #ff0000; 
            color: #ff0000; 
            border-radius: 0px; 
            font-family: 'Courier New', monospace;
        }
        .theme-nao-amigavel button { 
            background: #000; 
            color: #ff0000; 
            border: 1px solid #ff0000; 
            box-shadow: 0 0 10px #ff0000; 
            border-radius: 5px;
        }

        #input-area { padding: 20px; display: flex; gap: 10px; transition: 0.5s; }
        input { flex: 1; outline: none; transition: 0.3s; }
        button { border: none; width: 50px; height: 50px; cursor: pointer; font-size: 20px; transition: 0.3s; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body class="theme-amigavel">
    <audio id="sound-amigavel" src="https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3"></audio>
    <audio id="sound-nao-amigavel" src="https://assets.mixkit.co/active_storage/sfx/2565/2565-preview.mp3"></audio>

    <div id="sidebar">
        <div class="bg-particles" id="particle-container"></div>
        <div id="toggle-btn">üå∏</div>
        <p style="font-weight: bold; margin-top: 20px;">Clique para mudar a realidade</p>
    </div>

    <div id="chat-container">
        <div id="header">Modo Amig√°vel üå∏</div>
        <div id="messages"></div>
        <div id="input-area">
            <input type="text" id="msg-input" placeholder="Digite uma mensagem...">
            <button id="send-btn">‚ûî</button>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let currentRoom = 'amigavel';
        const user = "User_" + Math.floor(Math.random() * 999);
        let pInterval;

        function startParticles(emoji) {
            if (pInterval) clearInterval(pInterval);
            pInterval = setInterval(() => {
                const p = document.createElement('div');
                p.className = 'particle';
                p.innerText = emoji;
                p.style.left = Math.random() * 100 + '%';
                p.style.fontSize = (Math.random() * 20 + 10) + 'px';
                document.getElementById('particle-container').appendChild(p);
                setTimeout(() => p.remove(), 4000);
            }, 400);
        }

        document.getElementById('toggle-btn').onclick = function() {
            document.getElementById('particle-container').innerHTML = '';
            if (currentRoom === 'amigavel') {
                currentRoom = 'nao-amigavel';
                document.body.className = 'theme-nao-amigavel';
                this.innerText = 'üíÄ';
                document.getElementById('header').innerText = 'SISTEMA COMPROMETIDO üíÄ';
                startParticles('‚ö°');
            } else {
                currentRoom = 'amigavel';
                document.body.className = 'theme-amigavel';
                this.innerText = 'üå∏';
                document.getElementById('header').innerText = 'Modo Amig√°vel üå∏';
                startParticles('üå∏');
            }
            socket.emit('join room', currentRoom);
            document.getElementById('messages').innerHTML = '';
        };

        document.getElementById('send-btn').onclick = () => {
            const input = document.getElementById('msg-input');
            if (input.value) {
                socket.emit('chat message', { room: currentRoom, user: user, text: input.value });
                input.value = '';
            }
        };

        socket.on('chat message', (msg) => {
            const sound = document.getElementById(currentRoom === 'amigavel' ? 'sound-amigavel' : 'sound-nao-amigavel');
            sound.play().catch(() => {});

            const div = document.createElement('div');
            div.className = 'message ' + (msg.user === user ? 'my-message' : '');
            div.innerHTML = `<b>${msg.user}:</b><br>${msg.text}`;
            document.getElementById('messages').appendChild(div);
            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
        });

        startParticles('üå∏');
        socket.emit('join room', 'amigavel');
    </script>
</body>
</html>
